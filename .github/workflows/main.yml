# Nombre del flujo de trabajo para la tarea de Plulion
name: Smart Clinic Java CI

# Define cuándo se ejecutará esta automatización
on:
  push:
    branches: [ "main", "master" ] # Se activa al subir cambios a estas ramas
  pull_request:
    branches: [ "main", "master" ]

jobs:
  build:
    # Utiliza la versión más reciente de Ubuntu para el servidor de pruebas
    runs-on: ubuntu-latest

    steps:
    # 1. Descarga el código de tu repositorio de GitHub
    - name: Checkout del código
      uses: actions/checkout@v4

    # 2. Configura el entorno de Java (Versión 17, igual que en tu Mac)
    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'temurin'
        cache: maven

    # 3. Compila el proyecto usando Maven para verificar que no hay errores
    - name: Build with Maven
      run: mvn -B package --file pom.xml

    # 4. (Opcional) Verifica que las imágenes de Docker se pueden construir
    - name: Docker Build Check
      run: docker build -t clinic-test .